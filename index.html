<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Message Frequency</title><script src="https://d3js.org/d3.v7.min.js"></script><style>.a{display:flex;justify-content:center;align-items:center;margin-top:50px}.b{text-align:center;margin-top:20px}</style></head><body><div class="b"><input type="file" id="c" accept=".txt"/><button onclick="d()">Analyze File</button></div><div><h3>Settings:</h3><script>function e(){f=!f;g=`Remove Emojis: ${f?"ON":"OFF"}`;document.getElementById("h").innerText=g}</script><button id="h" onclick="e()">Remove Emojis: ON</button><script>function i(){const j=prompt("Enter a word to ban:");if(j){k.push(j)}document.getElementById("l").innerText="Banned Words: "+k.join(" | ")}function m(){const n=prompt("Enter a word to unban:");if(n){k=k.filter(o=>o!==n)}document.getElementById("l").innerText="Banned Words: "+k.join(" | ")}</script><button onclick="i()">Add Banned Word</button><button onclick="m()">Remove Banned Word</button><p id="l">Banned Words:</p></div><div class="a"><svg id="p" width="500" height="500"></svg></div><div><h2>Leaderboard:</h2><pre id="q"></pre></div><script>const r=/\d{2}\.\d{2}\.\d{2}, \d{2}:\d{2} - (.*?): (.*)/,s=/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F1E0}-\u{1F1FF}]+/gu;let k=["<medien","ausgeschlossen>","lero","<media","omitted>","this message was deleted"];document.getElementById("l").innerText="Banned Words: "+k.join(" | ");let f=!0,u={},v=[];function d(){const w=document.getElementById("c").files[0];if(!w){alert("Please upload a file.");return}const x=new FileReader;x.onload=function(e){const y=e.target.result.split("\n"),z=A(y).u,a=gw(z);D(a),G(a)};x.readAsText(w,"UTF-8")}function A(a){let u={},v=[];a.forEach(b=>{const c=r.exec(b);if(c){let d=c[1].trim(),e=c[2].trim().toLowerCase();k.forEach(g=>{e=e.replace(g,"")});e=e.trim(),f&&(e=e.replace(s,"")),e&&(u[d]||(u[d]=[]),u[d].push(e),v.push(e))}});return{u,v}}function gw(a){let b={};return Object.keys(a).forEach(c=>{b[c]=C(a[c])}),b}function C(a){const b={};return a.forEach(c=>{const d=c.split(" ");d.forEach(e=>{e=e.toLowerCase(),e&&(b[e]=(b[e]||0)+1)})}),sortFrequency(b)}function sortFrequency(a){return Object.entries(a).sort((b,c)=>c[1]-b[1])}function D(a){let b=document.getElementById("q");b.innerHTML="";let c=1;const d=Object.entries(a).sort((f,g)=>F(g[1])-F(f[1]));for(const[h,i]of d)b.innerHTML+=`<div id="place-${c}>"`,b.innerHTML+=`<h3>${c}. User: ${h}</h3>`,b.innerHTML+=`<p> Total words: ${F(i)}</p>`,b.innerHTML+=`<table><tr><th>Word</th><th>Frequency</th></tr>${i.slice(0,5).map(j=>`<tr><td>${j[0]}</td><td>${j[1]}</td></tr>`).join("")}</table>`,b.innerHTML+="</div>",c++}function F(a){return a.reduce((b,c)=>b+c[1],0)}function G(a){const b=Object.keys(a),c=b.map(d=>F(a[d])),d=b.map((e,f)=>({label:e.replace("HTL",""),value:c[f]})),h=500,i=500,j=Math.min(h,i)/2,k=d3.select("#p").attr("width",h).attr("height",i).append("g").attr("transform",`translate(${h/2},${i/2})`),l=d3.scaleOrdinal(d3.schemeCategory10),m=d3.pie().value(n=>n.value),o=d3.arc().innerRadius(0).outerRadius(j),p=k.selectAll("arc").data(m(d)).enter().append("g").attr("class","arc");p.append("path").attr("d",o).attr("fill",q=>l(q.data.label)),p.append("text").attr("transform",r=>`translate(${o.centroid(r)})`).attr("text-anchor","middle").text(s=>s.data.label)} </script></body></html>
